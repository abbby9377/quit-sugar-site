<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æˆ’ç³–è¨ˆç•«ï½œ8 é€±æº«æŸ”æˆ’ç³– Reset</title>
  <meta name="description" content="å°ˆç‚ºå¥³æ€§è¨­è¨ˆçš„ 8 é€±æº«æŸ”æˆ’ç³–è¨ˆç•«ï¼šä¸èµ°æ¥µç«¯ã€å¾ªåºæ¼¸é€²ã€‚é‡å»ºç©©å®šèƒ½é‡ã€å¥½ç¡çœ èˆ‡å¥½å¿ƒæƒ…ã€‚" />
  <meta name="theme-color" content="#f472b6" />

  <!-- å­—é«” -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;700;800&family=Noto+Serif+TC:wght@700&display=swap" rel="stylesheet">

  <style>
  :root{
    --bg:#ffffff; --panel:#ffffff; --ink:#0b1220; --muted:#475569; --line:#e5e7eb;
    --brand:#ec4899; --brand-2:#f472b6; --brand-3:#fb7185;
    --promo:#fff1f5; --accent:#fdf2f8;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:var(--bg);color:var(--ink);
    font-family:'Noto Sans TC',system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  img{max-width:100%;display:block}
  a{color:#2563eb;text-decoration:none}
  a:hover{text-decoration:underline}
  .wrap{max-width:1120px;margin:0 auto;padding:0 20px 80px}

  /* ä¿ƒéŠ·æ¢ */
  .promo{
    background:var(--promo);border-bottom:1px solid var(--line);
    text-align:center;padding:10px 12px;color:#7a294a;font-weight:700
  }
  .promo .btn{margin-left:10px}

  /* Header */
  header.site{position:sticky;top:0;background:#fff;z-index:20;border-bottom:1px solid var(--line)}
  .nav{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:14px 0}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:44px;height:44px;border-radius:14px;background:linear-gradient(135deg,var(--brand-2),var(--brand));display:grid;place-items:center;color:#fff;font-weight:900}
  .title{margin:0;font-size:22px;letter-spacing:.3px}
  .nav-links{display:flex;gap:16px;align-items:center}

  /* Buttons */
  .btn{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);
       padding:12px 16px;border-radius:999px;background:#fff;color:var(--ink);cursor:pointer;white-space:nowrap}
  .btn.primary{background:linear-gradient(135deg,var(--brand-2),var(--brand));color:#fff;border:none;font-weight:800}
  .btn.ghost{background:transparent}
  .btn[disabled]{opacity:.6;cursor:not-allowed}

  /* Hero */
  .hero{background:linear-gradient(180deg,#fff,#fff 34%,#fdf2f8 34%,#fdf2f8);border-bottom:1px solid var(--line)}
  .hero-inner{display:grid;gap:26px;grid-template-columns:1.1fr 1fr;align-items:center;padding:34px 0}
  .eyebrow{display:inline-block;color:#a21caf;background:#fce7f3;border:1px solid #fbcfe8;padding:4px 10px;border-radius:999px;font-weight:700;font-size:12px;margin-bottom:8px}
  .hero h1{font-family:"Noto Serif TC",serif;font-weight:700;font-size:34px;line-height:1.25;margin:0 0 10px;letter-spacing:.2px}
  .hero p{color:#475569;margin:0 0 16px;max-width:60ch}
  .chips{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  .chip{padding:8px 12px;border:1px solid var(--line);border-radius:999px;background:#fff;color:#334155}
  .hero-media{justify-self:end}
  .hero-media img{width:min(480px,100%);height:auto;border-radius:24px;border:1px solid var(--line);box-shadow:0 20px 60px rgba(236,72,153,.15)}

  /* ä¿¡ä»»å€ */
  .trust{padding:20px 0 8px}
  .trust small{display:block;color:#64748b;margin-bottom:10px;text-align:center}
  .logos{display:grid;grid-template-columns:repeat(6,1fr);gap:10px}
  .logo-skel{height:46px;border-radius:10px;border:1px dashed #cbd5e1;background:#fff;display:grid;place-items:center;color:#94a3b8;font-weight:700}

  /* äº®é» */
  .features{padding:22px 0}
  .grid4{display:grid;gap:12px}
  @media(min-width:860px){.grid4{grid-template-columns:repeat(4,1fr)}}
  .feature{background:#fff;border:1px solid var(--line);border-radius:16px;padding:14px}
  .feature .feat-photo{width:100%;height:128px;border-radius:12px;object-fit:cover;border:1px solid var(--line);margin-bottom:10px}
  .feature h4{margin:8px 0 6px}
  .icon{width:34px;height:34px;border-radius:10px;background:linear-gradient(135deg,#fde68a,#fca5a5);display:grid;place-items:center}

  /* ä¸‰æ­¥é©Ÿ */
  .steps{padding:8px 0}
  .steps-grid{display:grid;gap:12px}
  @media(min-width:860px){.steps-grid{grid-template-columns:repeat(3,1fr)}}
  .step{background:#fff;border:1px solid var(--line);border-radius:16px;padding:14px}
  .step .thumb{width:100%;height:auto;border-radius:12px;object-fit:cover;border:1px solid var(--line);margin-top:10px}
  .step .num{font-weight:800;color:var(--brand)}

  /* æˆåŠŸæ•…äº‹è¼ªæ’­ */
  .carousel{position:relative;margin:12px 0}
  .track{display:flex;gap:12px;overflow-x:auto;scroll-snap-type:x mandatory;padding-bottom:8px}
  .card{scroll-snap-align:center;min-width:82%;background:#fff;border:1px solid var(--line);border-radius:16px;padding:14px;display:grid;gap:8px}
  @media(min-width:900px){.card{min-width:40%}}
  .car-btn{position:absolute;top:42%;transform:translateY(-50%);border:none;width:42px;height:42px;border-radius:999px;background:#fff;box-shadow:0 6px 16px rgba(15,23,42,.08);cursor:pointer}
  .car-btn.prev{left:-8px} .car-btn.next{right:-8px}
  .quote{color:#334155}
  .who{color:#64748b}

  /* æ¨è–¦é›»å­æ›¸ */
  .ebooks{padding:6px 0 2px}
  .ebooks .section-head{text-align:center;margin:8px 0 12px}
  .ebook-grid{display:grid;gap:16px;justify-content:center;grid-template-columns:repeat(1,minmax(240px,280px))}
  @media(min-width:700px){ .ebook-grid{grid-template-columns:repeat(2,minmax(240px,280px));} }
  @media(min-width:1000px){ .ebook-grid{grid-template-columns:repeat(4,minmax(240px,280px));} }
  .ebook-card{background:#fff;border:1px solid var(--line);border-radius:16px;padding:12px;box-shadow:0 8px 22px rgba(15,23,42,.06);display:flex;flex-direction:column;align-items:center}
  .ebook-cover{width:100%;height:auto;border-radius:12px;border:1px solid var(--line);object-fit:cover}
  .ebook-title{font-weight:800;margin:10px 0 4px;text-align:center}
  .ebook-meta{font-size:12px;color:#64748b;text-align:center;margin-bottom:8px}
  .ebook-card .btn{width:100%;justify-content:center}

  /* CTA æ¢ */
  .cta{margin:22px 0;background:linear-gradient(135deg,#fff1f2,#fdf2f8 40%,#eef2ff);border:1px solid var(--line);border-radius:18px;padding:16px;display:grid;gap:12px}
  .wrap.cta{max-width:880px;margin-left:auto;margin-right:auto;}
  @media(min-width:860px){
    .cta{grid-template-columns:auto auto;align-items:center;justify-content:center;column-gap:24px}
  }
  @media(max-width:859px){
    .cta{text-align:center}
    .cta > div:last-child{justify-self:center}
  }

  /* ç™»å…¥/è¿½è¹¤ */
  .panel{background:#fff;border:1px solid var(--line);border-radius:18px;padding:16px;display:grid;gap:12px}
  .row{display:grid;gap:10px}
  .row2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .stat{display:flex;gap:14px}
  .num{font-size:28px;font-weight:800}
  .progress-bar{height:10px;background:#f1f5f9;border-radius:999px;overflow:hidden;border:1px solid var(--line)}
  .progress-bar span{display:block;height:100%;width:0;background:linear-gradient(135deg,var(--brand-2),var(--brand-3))}
  .muted{color:var(--muted)}
  footer{margin-top:32px;color:#94a3b8;text-align:center}
  </style>

  <!-- éŒ¯èª¤é¡¯ç¤º -->
  <script>
    window.onerror = function(msg, src, line, col) {
      var box = document.getElementById('auth-error');
      if (box) { box.style.display = 'block'; box.textContent = 'å‰ç«¯éŒ¯èª¤ï¼š' + msg + ' (' + src + ':' + line + ':' + col + ')'; }
    };
  </script>

  <!-- Supabaseï¼ˆé›™ CDNï¼‰ -->
  <script>
    (function loadSupabaseSDK() {
      var primary = "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js";
      var fallback = "https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js";
      function append(src){
        var s=document.createElement('script');s.src=src;s.defer=true;
        s.onload=function(){window.__supabaseReady=true};
        s.onerror=function(){
          if(src===primary){append(fallback)}
          else{
            var el=document.getElementById('auth-error');
            if(el){el.style.display='block';el.textContent='è¼‰å…¥ Supabase å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚'}
          }
        };
        document.head.appendChild(s)
      }
      append(primary);
    })();
  </script>
</head>
<body>
  <!-- ä¿ƒéŠ·æ¢ -->
  <div class="promo" role="region" aria-label="ä¿ƒéŠ·è¨Šæ¯">
    8 é€±æˆ’ç³– Reset é–‹æ”¾å ±å â€” é™æ™‚åé¡ã€‚
    <a class="btn" href="#join" aria-label="ç«‹å³åŠ å…¥">ç«‹å³åŠ å…¥</a>
  </div>

  <!-- Header -->
  <header class="site" role="banner">
    <div class="wrap nav">
      <div class="brand">
        <div class="logo" aria-hidden="true">QS</div>
        <div>
          <h1 class="title" style="margin:0">æˆ’ç³–è¨ˆç•« Quit Sugar</h1>
          <small class="muted">æº«æŸ”é–‹å§‹ãƒ»æŒçºŒè¨˜éŒ„ãƒ»çœ‹è¦‹æ”¹è®Š</small>
        </div>
      </div>
      <nav class="nav-links" aria-label="ä¸»å°è¦½">
        <a href="./">æˆ’ç³–é¦–é </a>
        <a href="./analyzer.html">é£Ÿç‰©å¡è·¯é‡Œåˆ†æå™¨</a>
        <a href="./ebooks.html">é›»å­æ›¸å•†åº—</a>
        <a href="#join" class="btn primary">åŠ å…¥ 8 é€± Reset</a>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="wrap hero-inner">
      <div>
        <span class="eyebrow">ç‚ºå¥³æ€§è¨­è¨ˆ</span>
        <h1>ä½ çš„æº«æŸ”å¥åº·é‡å•Ÿï¼Œå¾ä»Šå¤©é–‹å§‹</h1>
        <p>
          ä¸å¿…æ¥µç«¯ã€ä¹Ÿä¸éœ€è¦å®Œç¾ã€‚é€™æ˜¯ä¸€å¥—å‹å–„èº«é«”èˆ‡å¿ƒæƒ…çš„æ¸›ç³–æ–¹æ³•ï¼Œ
          çµ¦è‡ªå·± 8 é€±ï¼Œå»ºç«‹æ›´ç©©å®šçš„èƒ½é‡èˆ‡æ›´å¹³éœçš„é£²é£Ÿé—œä¿‚ã€‚
        </p>
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px">
          <a class="btn primary" href="#join" aria-label="åŠ å…¥ 8 é€±æˆ’ç³–è¨ˆç•«">åŠ å…¥ 8 é€±æˆ’ç³–è¨ˆç•«</a>
          <a class="btn" href="#auth" aria-label="ç™»å…¥æˆ–è¨»å†Š">ç™»å…¥ / è¨»å†Š</a>
        </div>
        <div class="chips" aria-label="ç‚ºä»€éº¼æœ‰æ•ˆ">
          <span class="chip">ä¸èµ°å…¨æˆ–ç„¡</span>
          <span class="chip">ç‡Ÿé¤Šå¸«èƒŒæ›¸</span>
          <span class="chip">è¼•é‹å‹•ï¼‹æ­£å¿µ</span>
          <span class="chip">è´ˆé€ 5 æœ¬é›»å­æ›¸</span>
        </div>
      </div>
      <div class="hero-media" aria-hidden="true">
        <picture>
          <source srcset="./assets/feature-mind-body.webp" type="image/webp">
          <img src="./assets/feature-mind-body.jpg" alt="ç‘œä¼½èˆ‡å‘¼å¸çš„å¹³éœç‰‡åˆ»ï¼Œèº«å¿ƒå¹³è¡¡">
        </picture>
      </div>
    </div>
  </section>

  <!-- ä¿¡ä»»å€ -->
  <section class="wrap trust" aria-label="ç¤¾ç¾¤å£ç¢‘">
    <small>å—åˆ°è¨±å¤šå¥³æ€§ç¤¾ç¾¤å–œæ„›</small>
    <div class="logos">
      <div class="logo-skel">LOGO</div>
      <div class="logo-skel">LOGO</div>
      <div class="logo-skel">LOGO</div>
      <div class="logo-skel">LOGO</div>
      <div class="logo-skel">LOGO</div>
      <div class="logo-skel">LOGO</div>
    </div>
  </section>

  <!-- å››å¤§äº®é» -->
  <section class="wrap features" aria-label="è¨ˆç•«äº®é»">
    <div class="grid4">
      <div class="feature">
        <picture><source srcset="./assets/feature-warm-approach.webp" type="image/webp"><img class="feat-photo" src="./assets/feature-warm-approach.jpg" alt="æº«æŸ”é–‹å§‹ã€å‹å–„é™ªä¼´"></picture>
        <div class="icon" aria-hidden="true">ğŸ’—</div>
        <h4>æº«æŸ”ï¼Œä¸æ˜¯åš´è‹›</h4>
        <p class="muted">å°æ­¥æ…¢èµ°ã€è²¼è¿‘ç”Ÿæ´»ã€‚å£“åŠ›æ›´å°ã€æˆåŠŸç‡æ›´é«˜ã€‚</p>
      </div>
      <div class="feature">
        <picture><source srcset="./assets/feature-tasty-low-sugar.webp" type="image/webp"><img class="feat-photo" src="./assets/feature-tasty-low-sugar.jpg" alt="å¥½åƒä¹Ÿèƒ½å°‘ç³–"></picture>
        <div class="icon" aria-hidden="true">ğŸ¥—</div>
        <h4>å¥½åƒï¼Œä¸å§”å±ˆ</h4>
        <p class="muted">ç°¡å–®æ›¿ä»£èˆ‡æ˜“åšé£Ÿè­œï¼Œä¸å¿…è¨ˆç®—å¡è·¯é‡Œã€‚</p>
      </div>
      <div class="feature">
        <picture><source srcset="./assets/feature-mind-body.webp" type="image/webp"><img class="feat-photo" src="./assets/feature-mind-body.jpg" alt="èº«å¿ƒä¸€èµ·ç…§é¡§"></picture>
        <div class="icon" aria-hidden="true">ğŸ§˜â€â™€ï¸</div>
        <h4>èº«å¿ƒï¼Œä¸€èµ·ç…§é¡§</h4>
        <p class="muted">ç¡çœ ã€å£“åŠ›èˆ‡è¼•é‹å‹•çš„æ”¯æŒï¼Œè®“æ¸´æœ›æ›´å¥½ç®¡ç†ã€‚</p>
      </div>
      <div class="feature">
        <picture><source srcset="./assets/feature-progress.webp" type="image/webp"><img class="feat-photo" src="./assets/feature-progress.jpg" alt="çœ‹å¾—è¦‹çš„æˆå°±æ„Ÿ"></picture>
        <div class="icon" aria-hidden="true">ğŸ“ˆ</div>
        <h4>æˆå°±æ„Ÿï¼Œçœ‹å¾—è¦‹</h4>
        <p class="muted">ç”¨ streaks è¿½è¹¤èˆ‡æ…¶ç¥é€²æ­¥ï¼Œä¸åªçœ‹é«”é‡ã€‚</p>
      </div>
    </div>
  </section>

  <!-- ä¸‰æ­¥é©Ÿï¼ˆå·²æ›¿æ›ç‚ºä½ æä¾›çš„ä¸‰å¼µç…§ç‰‡ï¼‰ -->
  <section class="wrap steps" aria-label="å¦‚ä½•é–‹å§‹">
    <h3 style="margin:8px 0">ä¸‰æ­¥é©Ÿé–‹å§‹ï¼ˆä»Šå¤©å°±èƒ½åšï¼‰</h3>
    <div class="steps-grid">
      <div class="step">
        <div class="num">Step 1</div>
        <strong>å»ºç«‹å°ç›®æ¨™</strong>
        <p class="muted">é¸æ“‡èµ·å§‹æ—¥èˆ‡ 1% æ”¹è®Šï¼Œé‚å‡ºç¬¬ä¸€æ­¥ã€‚</p>
        <picture>
          <source srcset="./assets/step1-goal.webp" type="image/webp">
          <img class="thumb" src="./assets/step1-goal.jpg" alt="è¦åŠƒèµ·é»èˆ‡ç›®æ¨™ï¼šæ‰‹å¯« Small goal / 1% çš„ç­†è¨˜æœ¬èˆ‡æœˆæ›†">
        </picture>
        <small class="muted">è¦åŠƒèµ·é»èˆ‡ç›®æ¨™</small>
      </div>

      <div class="step">
        <div class="num">Step 2</div>
        <strong>æ¯å¤© 1 å€‹å°è¡Œå‹•</strong>
        <p class="muted">ä¾‹å¦‚ï¼šæ™šé¤ä¸å–å«ç³–é£²æ–™ï¼Œæˆ–æ•£æ­¥ 20 åˆ†é˜ã€‚</p>
        <picture>
          <source srcset="./assets/step2-action.webp" type="image/webp">
          <img class="thumb" src="./assets/step2-action.jpg" alt="æ—¥å¸¸å¯è¡Œçš„å°è¡Œå‹•ï¼šé®­é­šã€è—œéº¥èˆ‡è èœæ­é…æª¸æª¬æ°´">
        </picture>
        <small class="muted">æ—¥å¸¸å¯è¡Œçš„å°è¡Œå‹•</small>
      </div>

      <div class="step">
        <div class="num">Step 3</div>
        <strong>è¨˜éŒ„æˆå°±ã€æ¯é€±å¾®èª¿</strong>
        <p class="muted">ç”¨é€£å‹å¤©æ•¸ä¿æŒå‹•åŠ›ï¼Œä¾é«”æ„ŸæŒçºŒå¾®èª¿ã€‚</p>
        <picture>
          <source srcset="./assets/step3-track.webp" type="image/webp">
          <img class="thumb" src="./assets/step3-track.jpg" alt="ç¿’æ…£è¿½è¹¤èˆ‡é€£å‹ï¼šå­å½ˆç­†è¨˜ Habit tracker èˆ‡æ‰‹æ©Ÿé¡¯ç¤º Streak 6 å¤©">
        </picture>
        <small class="muted">è¨˜éŒ„æˆå°±ã€æ¯é€±å¾®èª¿</small>
      </div>
    </div>
  </section>

  <!-- æˆåŠŸæ•…äº‹ï¼ˆè¼ªæ’­ï¼‰ -->
  <section class="wrap" aria-label="æˆåŠŸæ•…äº‹">
    <h3 style="margin:8px 0">æˆåŠŸæ•…äº‹</h3>
    <div class="carousel">
      <button class="car-btn prev" id="t-prev" aria-label="ä¸Šä¸€å‰‡">â€¹</button>
      <div class="track" id="t-track">
        <div class="card">
          <strong>Michelleï½œ-13 å…¬æ–¤</strong>
          <p class="quote">ä¸‹åˆå´©å£æ¶ˆå¤±äº†ï¼Œçš®è†šä¹Ÿç©©å®šè¨±å¤šï¼Œæ™šä¸Šæ›´å¥½ç¡ã€‚</p>
          <div class="who">8 é€±å®Œæˆè€…</div>
        </div>
        <div class="card">
          <strong>Rosieï½œ-20 å…¬æ–¤</strong>
          <p class="quote">ä¸å†å®³æ€•å¥½æ²¹è„‚ã€‚ä»£è¬ç©©ä¸‹ä¾†å¾Œï¼Œèƒ½é‡å›ä¾†äº†ã€‚</p>
          <div class="who">8 é€±å®Œæˆè€…</div>
        </div>
        <div class="card">
          <strong>Jadeï½œ-4 å…¬æ–¤</strong>
          <p class="quote">ç¬¬äº”é€±é–‹å§‹æ„Ÿåˆ°èº«é«”è®Šè¼•ç›ˆï¼Œé‡å›å–œæ­¡çš„ç‰›ä»”è¤²ã€‚</p>
          <div class="who">8 é€±å®Œæˆè€…</div>
        </div>
      </div>
      <button class="car-btn next" id="t-next" aria-label="ä¸‹ä¸€å‰‡">â€º</button>
    </div>
  </section>

  <!-- æ¨è–¦é›»å­æ›¸ -->
  <section id="ebooks" class="wrap ebooks" aria-label="æ¨è–¦é›»å­æ›¸">
    <div class="section-head">
      <h3 style="margin:6px 0">æ¨è–¦é›»å­æ›¸</h3>
      <p class="muted" style="margin:0">æŠŠæ¸›ç³–è½åœ°åˆ°æ—¥å¸¸ï¼šå…¥é–€æŒ‡å—ã€æ—©é¤ã€å¤–é£Ÿèˆ‡é›¶ç³–ç”œé»ç²¾é¸ã€‚</p>
    </div>

    <div class="ebook-grid">
      <article class="ebook-card">
        <picture>
          <source srcset="./assets/feature-warm-approach.webp" type="image/webp">
          <img class="ebook-cover" src="./assets/feature-warm-approach.jpg" alt="8 é€±æˆ’ç³–å…¥é–€ é›»å­æ›¸å°é¢">
        </picture>
        <div class="ebook-title">8 é€±æˆ’ç³–å…¥é–€</div>
        <div class="ebook-meta">å¾ªåºæ¸›ç³–ã€ç©©å®šèƒ½é‡èˆ‡å¿ƒæƒ…</div>
        <a class="btn primary" href="./ebooks.html#reset-8w">ç«‹å³è³¼è²·</a>
      </article>

      <article class="ebook-card">
        <picture>
          <source srcset="./assets/feature-tasty-low-sugar.webp" type="image/webp">
          <img class="ebook-cover" src="./assets/feature-tasty-low-sugar.jpg" alt="ä½ç³–æ—©é¤ 20 é“ é›»å­æ›¸å°é¢">
        </picture>
        <div class="ebook-title">ä½ç³–æ—©é¤ 20 é“</div>
        <div class="ebook-meta">ä¸€å¤©çš„è¼•ç”œé–‹å§‹</div>
        <a class="btn" href="./ebooks.html#breakfast-20">ç«‹å³è³¼è²·</a>
      </article>

      <article class="ebook-card">
        <picture>
          <source srcset="./assets/feature-mind-body.webp" type="image/webp">
          <img class="ebook-cover" src="./assets/feature-mind-body.jpg" alt="å¤–é£Ÿå°‘ç³–å°æŠ„ é›»å­æ›¸å°é¢">
        </picture>
        <div class="ebook-title">å¤–é£Ÿå°‘ç³–å°æŠ„</div>
        <div class="ebook-meta">å¤–é£Ÿæ—å‹å–„æ”»ç•¥</div>
        <a class="btn" href="./ebooks.html#eating-out">ç«‹å³è³¼è²·</a>
      </article>

      <article class="ebook-card">
        <picture>
          <source srcset="./assets/feature-progress.webp" type="image/webp">
          <img class="ebook-cover" src="./assets/feature-progress.jpg" alt="é›¶ç³–ç”œé» 15 é“ é›»å­æ›¸å°é¢">
        </picture>
        <div class="ebook-title">é›¶ç³–ç”œé» 15 é“</div>
        <div class="ebook-meta">ç”œè€Œä¸è†©çš„å„€å¼æ„Ÿ</div>
        <a class="btn" href="./ebooks.html#desserts-15">ç«‹å³è³¼è²·</a>
      </article>
    </div>

    <div style="text-align:center;margin-top:10px">
      <a class="btn" href="./ebooks.html">å‰å¾€é›»å­æ›¸å•†åº—</a>
    </div>
  </section>

  <!-- CTA æ¢ -->
  <section id="join" class="wrap cta" aria-label="åŠ å…¥è¨ˆç•«">
    <div>
      <h3 style="margin:6px 0">8 é€±æˆ’ç³– Resetãƒ»ç¾åœ¨å°±å•Ÿå‹•</h3>
      <p class="muted" style="margin:0">åŠ å…¥è¶…é 200,000 ä½å®Œæˆè€…çš„è¡Œåˆ—ï¼Œæ‰¾å›ç©©å®šèƒ½é‡èˆ‡æ›´å¹³éœçš„é£²é£Ÿé—œä¿‚ã€‚</p>
    </div>
    <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
      <a class="btn primary" href="#auth" aria-label="åŠ å…¥æˆ–ç™»å…¥">ç«‹å³åŠ å…¥ / ç™»å…¥</a>
      <a class="btn" href="./ebooks.html" aria-label="é ˜å–é›»å­æ›¸">é ˜å–é›»å­æ›¸</a>
    </div>
  </section>

  <!-- ç™»å…¥ / è¿½è¹¤ -->
  <section class="wrap" id="auth" aria-label="å€‹äººåŒ–è¿½è¹¤">
    <div class="panel">
      <span class="muted" style="font-weight:700">å€‹äººåŒ–è¿½è¹¤</span>
      <h2 style="margin:0">è¨»å†Š / ç™»å…¥</h2>

      <div class="row2" role="group" aria-label="Email èˆ‡å¯†ç¢¼">
        <input id="signup-email" placeholder="Emailï¼ˆå»ºè­°æ‰‹å‹•è¼¸å…¥ï¼‰" inputmode="email" autocomplete="username" aria-label="Email" />
        <input id="signup-password" placeholder="å¯†ç¢¼ï¼ˆè‡³å°‘ 6 ç¢¼ï¼‰" type="password" autocomplete="new-password" aria-label="å¯†ç¢¼" />
      </div>
      <div class="row2" style="margin-top:8px">
        <button class="btn primary" id="btn-signup" aria-label="è¨»å†Š">è¨»å†Š</button>
        <button class="btn" id="btn-login" aria-label="ç™»å…¥">ç™»å…¥</button>
      </div>
      <div class="row" style="margin-top:8px">
        <button class="btn ghost" id="btn-logout" style="display:none" aria-label="ç™»å‡º">ç™»å‡º</button>
      </div>
      <div id="auth-error" class="panel" style="display:none;border-color:#fecaca;background:#fff5f5"></div>

      <hr style="border:0;border-top:1px solid var(--line)"/>

      <div class="stat" role="group" aria-label="é€£å‹çµ±è¨ˆ">
        <div>
          <div class="muted">ç•¶å‰é€£å‹ï¼ˆå¤©ï¼‰</div>
          <div class="num" id="current-streak">â€”</div>
        </div>
        <div>
          <div class="muted">æ­·å²æœ€é•·ï¼ˆå¤©ï¼‰</div>
          <div class="num" id="max-streak">â€”</div>
        </div>
      </div>

      <div class="row">
        <div class="muted" style="margin:8px 0 6px"><strong>æ¯é€±æŒ‘æˆ°ï¼š</strong>æ™šé¤ä¸å–å«ç³–é£²æ–™</div>
        <div class="progress-bar" aria-label="æœ¬é€±é€²åº¦"><span id="week-fill"></span></div>
        <small class="muted"><span id="week-label">æœ¬é€±å®Œæˆ 0 / 7 å¤©</span></small>
      </div>

      <div class="row2" style="margin-top:12px">
        <button class="btn" id="btn-i-did-good" aria-label="æˆ‘ä»Šå¤©æˆ’ç³–">æˆ‘ä»Šå¤©æˆ’ç³– âœ…</button>
        <button class="btn" id="btn-reset" style="border-color:#fecaca" aria-label="æˆ‘å¤±æ‰‹äº†ï¼Œé‡æ–°é–‹å§‹">æˆ‘å¤±æ‰‹äº†ï¼Œé‡æ–°é–‹å§‹</button>
      </div>
      <small class="muted">æç¤ºï¼šç™»å…¥å¾Œæ‰æœƒè®€å¯« <code>streaks</code> è³‡æ–™è¡¨ã€‚</small>
      <div id="auth-quick" class="muted" aria-live="polite"></div>
    </div>
  </section>

  <footer class="wrap" role="contentinfo">
    <p>Â© 2025 Quit Sugar. GitHub Pages Ã— Supabase</p>
  </footer>

<script>
  /* ===== å·¥å…· ===== */
  const $ = (id) => document.getElementById(id);
  const showErr = (msg) => { const box = $('auth-error'); if(!box) return; box.style.display = 'block'; box.textContent = msg; };
  const hideErr = () => { const box = $('auth-error'); if(!box) return; box.style.display = 'none'; box.textContent = ''; };
  function normalizeEmail(raw){ return (raw ?? '').normalize('NFKC').replace(/[\u200B-\u200D\uFEFF]/g,'').trim(); }
  function basicEmailOK(s){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s); }

  /* ===== æ¯é€±é€²åº¦ï¼ˆæœ¬åœ°ï¼‰ ===== */
  function isoWeek(d=new Date()){
    const t = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
    const dayNum = t.getUTCDay() || 7; t.setUTCDate(t.getUTCDate()+4-dayNum);
    const yearStart = new Date(Date.UTC(t.getUTCFullYear(),0,1));
    const weekNum = Math.ceil((((t-yearStart)/86400000)+1)/7); return {year:t.getUTCFullYear(),week:weekNum};
  }
  function todayStr(){ return new Date().toISOString().slice(0,10); }
  const WEEK_KEY_PREFIX = 'qs.weekMarks.';
  function weekKey(d=new Date()){ const w=isoWeek(d); return `${WEEK_KEY_PREFIX}${w.year}-${w.week.toString().padStart(2,'0')}`; }
  function getWeekSet(){ const raw = localStorage.getItem(weekKey()) || '[]'; try{return new Set(JSON.parse(raw))}catch{return new Set()} }
  function saveWeekSet(set){ localStorage.setItem(weekKey(), JSON.stringify(Array.from(set))); }
  function updateWeekUI(){ const set=getWeekSet(); const n=Math.min(7,set.size); const percent=(n/7)*100; $('week-fill').style.width = percent+'%'; $('week-label').textContent = `æœ¬é€±å®Œæˆ ${n} / 7 å¤©`; }
  function recordTodayIfNew(){ const set=getWeekSet(); const t=todayStr(); if(!set.has(t)){ set.add(t); saveWeekSet(set); } updateWeekUI(); }

  /* ===== è¦‹è­‰è¼ªæ’­ ===== */
  function initCarousel(){
    const track = $('t-track'); const prev=$('t-prev'); const next=$('t-next');
    if(!track||!prev||!next) return; const gap=12;
    const stepPx = () => { const first = track.querySelector('.card'); return first ? first.clientWidth + gap : Math.max(300, track.clientWidth*0.9); };
    function update(){ const can = track.scrollWidth > track.clientWidth + 1; prev.style.display=next.style.display = can ? 'inline-flex':'none'; }
    prev.addEventListener('click',()=>track.scrollBy({left:-stepPx(),behavior:'smooth'}));
    next.addEventListener('click',()=>track.scrollBy({left: stepPx(),behavior:'smooth'}));
    window.addEventListener('resize',update); update();
  }

  /* ===== Supabase èˆ‡ streaks ===== */
  async function waitSupabaseReady(ms=4000){ const start=Date.now(); while(!window.supabase && Date.now()-start<ms){ await new Promise(r=>setTimeout(r,50)); } return !!window.supabase; }

  window.addEventListener('DOMContentLoaded', async () => {
    updateWeekUI();
    initCarousel();
    const btnGood=$('btn-i-did-good'); const btnReset=$('btn-reset'); if(btnGood) btnGood.disabled=true; if(btnReset) btnReset.disabled=true;

    const ok = await waitSupabaseReady(4000);
    if(!ok){ showErr('Supabase å°šæœªå°±ç·’ï¼›ç™»å…¥/é€£å‹åŠŸèƒ½æš«ä¸å¯ç”¨ã€‚'); return; }

    const SUPABASE_URL = "https://scquprvywjtuvcxxfsco.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNjcXVwcnZ5d2p0dXZjeHhmc2NvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4MzAxMTQsImV4cCI6MjA3MTQwNjExNH0.iUZ_lI-mHoGoz2NfPTifYe44zieUIBUREF6fxsry97I";
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, { auth:{persistSession:true,autoRefreshToken:true,detectSessionInUrl:false} });

    async function signup(){
      hideErr();
      const email=normalizeEmail($('signup-email').value);
      const password=$('signup-password').value;
      if(!basicEmailOK(email)) return showErr('è«‹è¼¸å…¥æœ‰æ•ˆçš„ Emailã€‚');
      if((password||'').length<6) return showErr('å¯†ç¢¼è‡³å°‘ 6 ç¢¼ã€‚');
      const {data,error}=await supabaseClient.auth.signUp({email,password});
      if(error) return showErr('è¨»å†Šå¤±æ•—ï¼š' + (error.message || 'æœªçŸ¥éŒ¯èª¤'));
      if(!data.session) return showErr('è‹¥å•Ÿç”¨ä¿¡ç®±é©—è­‰ï¼Œè«‹è‡³ä¿¡ç®±æ”¶ä¿¡å¾Œå†å›ä¾†ç™»å…¥ã€‚');
      await afterLogin();
    }

    async function login(){
      hideErr();
      const email=normalizeEmail($('signup-email').value);
      const password=$('signup-password').value;
      if(!basicEmailOK(email)) return showErr('è«‹è¼¸å…¥æœ‰æ•ˆçš„ Emailã€‚');
      if((password||'').length<6) return showErr('å¯†ç¢¼è‡³å°‘ 6 ç¢¼ã€‚');
      const {error}=await supabaseClient.auth.signInWithPassword({email,password});
      if(error) return showErr('ç™»å…¥å¤±æ•—ï¼š' + (error.message || 'æœªçŸ¥éŒ¯èª¤'));
      await afterLogin();
    }

    async function logout(){ await supabaseClient.auth.signOut(); renderSession(null); }

    function daysBetween(start){
      const s=new Date(start+'T00:00:00'); const today=new Date();
      const diff=Math.floor((Date.UTC(today.getFullYear(),today.getMonth(),today.getDate())-Date.UTC(s.getFullYear(),s.getMonth(),s.getDate()))/(1000*60*60*24));
      return Math.max(0,diff+1);
    }

    async function ensureStreakRow(uid){
      const {data,error}=await supabaseClient.from('streaks').select('*').eq('user_id',uid).maybeSingle();
      if(error){ showErr('è®€å– streaks å¤±æ•—ï¼š'+error.message); return null; }
      if(data) return data;
      const today=new Date().toISOString().slice(0,10);
      const {data:inserted,error:e2}=await supabaseClient.from('streaks').insert({user_id:uid,current_streak_start_date:today,max_streak_days:0}).select().single();
      if(e2){ showErr('å»ºç«‹ streaks å¤±æ•—ï¼š'+e2.message); return null; }
      return inserted;
    }

    async function refreshStreaks(){
      const {data:{session}}=await supabaseClient.auth.getSession();
      if(!session) return;
      const row=await ensureStreakRow(session.user.id); if(!row) return;
      const current=daysBetween(row.current_streak_start_date);
      $('current-streak').textContent=current;
      $('max-streak').textContent=row.max_streak_days ?? 0;
    }

    async function markGoodToday(){
      const {data:{session}}=await supabaseClient.auth.getSession();
      if(!session) return showErr('è«‹å…ˆç™»å…¥ã€‚');
      const row=await ensureStreakRow(session.user.id); if(!row) return;
      const current=daysBetween(row.current_streak_start_date);
      const newMax=Math.max(row.max_streak_days ?? 0, current);
      const {error}=await supabaseClient.from('streaks').update({max_streak_days:newMax}).eq('user_id',session.user.id);
      if(error) return showErr('æ›´æ–°å¤±æ•—ï¼š'+error.message);
      recordTodayIfNew();
      await refreshStreaks();
    }

    async function resetStreak(){
      const {data:{session}}=await supabaseClient.auth.getSession();
      if(!session) return showErr('è«‹å…ˆç™»å…¥ã€‚');
      const row=await ensureStreakRow(session.user.id); if(!row) return;
      const today=new Date().toISOString().slice(0,10);
      const {error}=await supabaseClient.from('streaks').update({current_streak_start_date:today}).eq('user_id',session.user.id);
      if(error) return showErr('é‡ç½®å¤±æ•—ï¼š'+error.message);
      await refreshStreaks();
    }

    async function afterLogin(){
      const {data:{session}}=await supabaseClient.auth.getSession();
      renderSession(session);
      await refreshStreaks();
    }

    function renderSession(session){
      const quick=$('auth-quick'), btnLogout=$('btn-logout'), btnGood=$('btn-i-did-good'), btnReset=$('btn-reset');
      if(session){
        const email=session.user?.email || 'å·²ç™»å…¥';
        quick.textContent='ğŸ‘¤ '+email;
        btnLogout.style.display='inline-flex';
        if(btnGood) btnGood.disabled=false;
        if(btnReset) btnReset.disabled=false;
      }else{
        quick.textContent='æœªç™»å…¥';
        btnLogout.style.display='none';
        $('current-streak').textContent='â€”';
        $('max-streak').textContent='â€”';
        if(btnGood) btnGood.disabled=true;
        if(btnReset) btnReset.disabled=true;
      }
    }

    $('btn-signup').addEventListener('click', signup);
    $('btn-login').addEventListener('click', login);
    $('btn-logout').addEventListener('click', logout);
    $('btn-i-did-good').addEventListener('click', markGoodToday);
    $('btn-reset').addEventListener('click', resetStreak);

    const {data:{session}}=await supabaseClient.auth.getSession();
    renderSession(session); if(session){ await refreshStreaks(); }
    supabaseClient.auth.onAuthStateChange(function(_evt,sess){ renderSession(sess); if(sess){ refreshStreaks(); } });
  });
</script>

<!-- åœ–ç‰‡ fallbackï¼ˆè‹¥è³‡æºå¤±æ•—ä»¥ä½”ä½åœ–ä»£æ›¿ï¼‰ -->
<script>
(function(){
  const META={
    "feature-warm-approach":{label:"Warm Approach",bg:"#fce7f3"},
    "feature-tasty-low-sugar":{label:"Tasty Low Sugar",bg:"#fff4de"},
    "feature-mind-body":{label:"Mind & Body",bg:"#e6f5fa"},
    "feature-progress":{label:"Visible Progress",bg:"#e8f0ff"},
    "step1-goal":{label:"Step 1: Set Goal",bg:"#f0fcf4"},
    "step2-action":{label:"Step 2: Daily Action",bg:"#fff0f0"},
    "step3-track":{label:"Step 3: Track & Tune",bg:"#f5f5ff"}
  };
  const cache={};
  function gen(key,w=720,h=450){
    if(cache[key]) return cache[key];
    const m=META[key]||{label:key,bg:'#f1f5f9'};
    const c=document.createElement('canvas'); c.width=w; c.height=h; const g=c.getContext('2d');
    g.fillStyle=m.bg; g.fillRect(0,0,w,h);
    g.strokeStyle='#c8ccd8'; g.lineWidth=3; g.strokeRect(10,10,w-20,h-20);
    g.fillStyle='#334155'; g.font='bold 28px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif';
    const tw=g.measureText(m.label).width; g.fillText(m.label,(w-tw)/2,Math.round(h*0.55));
    g.fillStyle='#94a3b8'; g.font='16px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif';
    const tag='Quit Sugar'; const tw2=g.measureText(tag).width; g.fillText(tag,w-12-tw2,h-12);
    return (cache[key]=c.toDataURL('image/webp',0.9));
  }
  function attach(img){
    const src=img.getAttribute('src')||''; const m=src.match(/(?:^|\.|\/)assets\/([a-z0-9\-_]+)\.(?:webp|jpe?g|png)$/i);
    if(!m) return; const key=m[1];
    function onErr(){ img.removeEventListener('error',onErr); const w=img.clientWidth||720; const h=img.clientHeight||450; img.src=gen(key,w,h); }
    img.addEventListener('error',onErr,{once:true});
  }
  document.addEventListener('DOMContentLoaded',()=>{ document.querySelectorAll('img').forEach(attach); });
})();
</script>
</body>
</html>
